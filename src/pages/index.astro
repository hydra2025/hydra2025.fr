---
import Lore from "../layouts/boxes/Lore.astro";
import Button from "../components/Button.astro";
import Hero2Col from "../layouts/Hero2Col.astro";
import RotatingLogo from "../components/RotatingLogo.astro";
import Layout from "../layouts/Layout.astro";
import SubscribeButton from "../layouts/SubscribeButton.astro";
---

<Layout title="Liste BDE TMSP 2025">
  <Hero2Col>
    <div slot="left" id="hero-left">
      <h2 id="hero-text">
        Plonge dans l'aventure avec la mission <span id="accent">Hydra</span>
      </h2>
      <div class="button-grid">
        <Button href="/programme">La mission</Button>
        <Button href="/organigramme">L'équipage</Button>
        <Button href="/clip">Clip de campagne</Button>
        <Button href="/contact">Contact</Button>
      </div>
      <div id="event-counter">
        <div id="above-bar">
          <h2>Soirée de campagne <span class="accent">HYDRA</span></h2>
          <span id="timer"></span>
        </div>
        <div id="progress-container">
          <div id="progress-border"></div>
          <div id="progress-bar"></div>
        </div>
        <span id="final-date">7 février - 22h</span>
        <SubscribeButton />
      </div>
    </div>
    <RotatingLogo slot="right" />
  </Hero2Col>
  <h2 id="lore">Le Lore</h2>
  <Lore>
    <div slot="top">
      <p class="lore-p">
        <span class="accent">La planète bleue.</span> Notre Terre, âgée de 4,567
        milliards d'années, après des millénaires de tolérance silencieuse, s'est
        éveillée. Elle a décidé, enfin, de réclamer ce qui lui appartenait. Après
        5 000 ans d'exploitation humaine, de blessures infligées à chaque forêt rasée,
        chaque océan empoisonné, chaque écosystème brisé, la <span
          class="accent">nature</span
        > a repris le dessus.
      </p>
      <p class="lore-p">
        La surface de la Terre est désormais une terre interdite, un
        <span class="accent">désert</span>
        irradié par les rayons du soleil. La couche d'ozone, autrefois bouclier protecteur,
        n'est plus qu'un voile déchiré. La vie telle que nous la connaissions est
        devenue impossible là-haut, sur cette terre dévastée par nos propres <span
          class="accent">erreurs</span
        >. Les océans, gonflés de toutes les glaces fondues, engloutissent les
        côtes et submergent les villes disparues. Ce que nos ancêtres appelaient
        le réchauffement climatique n'est plus un simple terme dans des livres
        d'histoire <span class="accent">effacés</span>
        par le temps, mais une réalité qui s'impose, implacable.
      </p>
    </div>
    <div slot="left">
      <p class="lore-p">
        <span class="accent">L'eau</span>. Cette immensité glacée est notre seul
        refuge. Mais elle est aussi notre prison, une muraille liquide qui nous
        isole et nous oppresse. En dessous de la surface, dans les profondeurs
        où s'enfoncent nos bases sous-marines, nous subsistons en survivants,
        réduits à une existence d'acier et de machines. À travers les hublots de
        nos abris métalliques, nous percevons parfois des <span class="accent"
          >ombres</span
        > qui glissent dans l'obscurité, des
        <span class="accent">créatures immenses</span>, d'une puissance
        écrasante, comme les vestiges d'une mythologie qui aurait pris vie. Ces
        monstres marins ne sont autres que les descendants des cétacés, les
        baleines et les dauphins d'autrefois, transformés, évolués au fil des
        siècles, modelés par une planète en mutation.
      </p>
    </div>
    <div slot="right">
      <p class="lore-p">
        Là où il y avait de la grâce et de la douceur dans les océans, il n'y a
        plus que force et hostilité. Les créatures des profondeurs ont muté,
        gagnant en taille, en résistance, comme pour rappeler aux survivants
        humains que la Terre n'est plus la leur, qu'elle ne l'a jamais été. Ces
        créatures sont les gardiennes d'un royaume qui nous échappe, souveraines
        d'un territoire que nous ne faisons qu'habiter par tolérance,
        <span class="accent">prisonniers</span> de leur monde.
      </p>
      <p class="lore-p">
        Lorsque les premiers signes de cette apocalypse se firent sentir, les
        meilleurs scientifiques de notre espèce, dans un ultime sursaut, ont
        construit des <span class="accent">abris sous-marins</span>. Des
        structures de métal, capables, croyaient-ils, de résister aux assauts
        des créatures et aux mutations du monde extérieur. Mais ces
        avant-postes, conçus dans la précipitation et l'urgence, n'ont pas
        survécu aux épreuves du temps. La plupart des architectes, des
        ingénieurs, des ouvriers, ont péri dans cet ouvrage insensé, se
        sacrifiant dans l'<span class="accent">espoir</span> que, quelque part, l'humanité
        puisse trouver refuge dans les <span class="accent">profondeurs</span>.
      </p><p class="lore-p">
        Nous sommes les héritiers de cet espoir, trois siècles après les
        premières bases. <span class="accent">siècles</span> passés dans l'ombre,
        enfouis dans l'obscurité des abysses, coupés de la surface, forcés de contempler,
        impuissants, la lente transformation de la planète bleue. Mais au fond de
        cet exil marin, une rumeur se propage, murmurée dans les couloirs métalliques
        de l'<span class="accent">I.N.T.</span> : la mission <span
          class="accent title">HYDRA</span
        >, une mission abandonnée depuis longtemps, oubliée pour sa dangerosité,
        refait surface dans les esprits. <span class="accent title">HYDRA</span
        >, un nom comme un appel, un souvenir tenace. La mission d'<span
          class="accent title">HY</span
        >drographie de <span class="accent title">D</span>étection et de <span
          class="accent title">R</span
        >echerche des <span class="accent title">A</span>nomalies.
      </p><p class="lore-p">
        <span class="accent title">HYDRA</span> n'a qu'un seul but, audacieux, insensé
        : percer les mystères de ce monde marin, comprendre ses secrets, et, peut-être,
        identifier une solution qui permettrait à l'humanité de survivre. Qui sera
        assez fou pour reprendre cette mission ? <span class="accent"
          >Qui osera</span
        > se jeter dans ces ténèbres, affronter les colosses des profondeurs et les
        secrets qu'ils protègent jalousement ? Seuls les plus audacieux, les plus
        désespérés, ou peut-être les plus fous, répondront à l'appel.
      </p>
    </div>
  </Lore>
</Layout>

<script>
  const TIME_END = 1738962000000; // 7 février 2025 22h
  const TIME_START = 1735124983267; // 6 janvier 2025 1h 56min 23s
  const percent = () => {
    const now = Date.now();
    const total = TIME_END - TIME_START;
    const elapsed = now - TIME_START;
    return Math.min((elapsed / total) * 100, 100);
  };
  const getRemainingTime = () => {
    const now = Date.now();
    const remaining = TIME_END - now;
    const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
    const hours = Math.floor(
      (remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
    );
    const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
    if (days) return `${days}j ${hours}h et ${minutes}"`;
    if (hours) return `${hours}h et ${minutes}"`;
    if (minutes) return `${minutes}"`;
    if (seconds) return "Quelques secondes";
    return "Maintenant !";
  };
  const progressBar = document.getElementById("progress-bar") as HTMLDivElement;
  const timer = document.getElementById("timer") as HTMLSpanElement;
  const updateProgress = () => {
    progressBar.style.width = `${percent()}%`;
    timer.textContent = getRemainingTime();
  };
  setInterval(updateProgress, 30000);
  updateProgress();
</script>

<style>
  .accent {
    color: var(--color-primary);
  }
  .accent.title {
    font-family: var(--font-family-title);
    font-size: 1.2em;
  }

  p {
    font-size: 1.1em;
    line-height: 1.5em;
  }

  #accent {
    color: var(--color-primary);
    text-transform: uppercase;
    font-family: var(--font-family-title);
    font-size: 1.2em;
  }

  #hero-text {
    font-size: 3em;
    text-align: left;
    margin: 0;
    font-family: var(--font-family-text);
  }

  #hero-left {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100%;
    padding: 3em;
  }

  .button-grid {
    width: 100%;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1em 2em;
    margin-top: 1em;
  }

  @media screen and (max-width: 768px) {
    #hero-left {
      padding: 1em;
    }
    #hero-text {
      font-size: 2em;
    }

    .button-grid {
      grid-template-columns: 1fr;
    }
  }

  #lore {
    text-align: center;
    margin-top: 3em;
    font-family: var(--font-family-title);
    font-size: 4em;
  }

  .lore-p {
    margin-top: 0;
    margin-bottom: 1.5em;
  }

  /* Event counter */
  #event-counter {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 5em;
  }
  #above-bar {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-between;
    width: 100%;
  }

  #timer {
    font-size: 2em;
    margin-right: 30px;
  }

  #above-bar h2 {
    font-size: 1.5em;
    font-family: var(--font-family-text);
    margin: 0;
  }

  #above-bar h2 .accent {
    color: var(--color-primary);
    font-family: var(--font-family-title);
    font-weight: bolder;
    font-size: 1.1em;
  }

  #timer {
    font-family: var(--font-family-text);
    font-size: 1.5em;
    font-weight: lighter;
    color: var(--color-text);
  }

  #progress-container {
    width: 100%;
    height: 50px;
    margin-top: 3px;
    background-color: transparent;
    overflow: visible;
    position: relative;
    clip-path: polygon(
      5px 0%,
      0% 5px,
      0% calc(100% - 10px),
      10px 100%,
      calc(20% - 10px) 100%,
      20% calc(100% - 10px),
      calc(100% - 5px) calc(100% - 10px),
      100% calc(calc(100% - 10px) - 5px),
      100% 30px,
      calc(100% - 30px) 0%,
      5px 0%
    );
  }

  #progress-border {
    background-color: var(--color-primary);
    position: absolute;
    inset: 0;
    clip-path: polygon(
      5px 0%,
      0% 5px,
      0% calc(100% - 10px),
      10px 100%,
      calc(20% - 10px) 100%,
      20% calc(100% - 10px),
      calc(100% - 5px) calc(100% - 10px),
      100% calc(calc(100% - 10px) - 5px),
      100% 30px,
      calc(100% - 30px) 0%,
      5px 0%,
      calc(3px + calc(5px - calc(3px * 0.7071067811865475))) 3px,
      calc(calc(100% - 3px) - calc(30px - calc(3px * 0.7071067811865475))) 3px,
      calc(100% - 3px) calc(3px + calc(30px - calc(3px * 0.7071067811865475))),
      calc(100% - 3px)
        calc(
          calc(calc(100% - 10px) - 3px) -
            calc(5px - calc(3px * 0.7071067811865475))
        ),
      calc(calc(100% - 3px) - calc(5px - calc(3px * 0.7071067811865475)))
        calc(calc(100% - 10px) - 3px),
      calc(calc(20% - 3px) + calc(3px * 0.7071067811865475))
        calc(calc(100% - 3px) - 10px),
      calc(calc(20% - 3px) - calc(10px - calc(3px * 0.7071067811865475)))
        calc(100% - 3px),
      calc(3px + calc(10px - calc(3px * 0.7071067811865475))) calc(100% - 3px),
      3px calc(calc(100% - 3px) - calc(10px - calc(3px * 0.7071067811865475))),
      3px calc(3px + calc(5px - calc(3px * 0.7071067811865475))),
      calc(3px + calc(5px - calc(3px * 0.7071067811865475))) 3px
    );
  }

  #progress-bar {
    width: 0%;
    height: 100%;
    background-color: rgba(var(--color-primary-rgb), 0.5);
    transition: width 0.5s ease-in-out;
    animation: pulse 1s infinite ease-in-out;
    clip-path: polygon(
      0% 0%,
      0% 100%,
      100% 100%,
      100% 30px,
      calc(100% - 30px) 0%,
      0% 0%
    );
  }

  @keyframes pulse {
    0% {
      background-color: rgba(var(--color-primary-rgb), 0.5);
    }
    25% {
      background-color: rgba(var(--color-primary-rgb), 0.7);
    }
    50% {
      background-color: rgba(var(--color-primary-rgb), 0.5);
    }
    100% {
      background-color: rgba(var(--color-primary-rgb), 0.5);
    }
  }

  #final-date {
    display: block;
    margin-top: -10px;
    margin-bottom: 10px;
    font-weight: bold;
  }
</style>
